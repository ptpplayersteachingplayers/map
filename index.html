
<!DOCTYPE html>
<html>
<head>
  <title>PTP Field + Trainer Matcher</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
    #map { height: 500px; width: 100%; border-radius: 10px; margin-top: 20px; }
    input, button {
      padding: 10px; margin: 5px; font-size: 1em;
      border-radius: 6px; border: 1px solid #ccc;
    }
    button { background: #FFD700; font-weight: bold; cursor: pointer; }
    #results { margin-top: 20px; max-width: 600px; margin-left: auto; margin-right: auto; }
  </style>
</head>
<body>

<h2>⚽ Find a Soccer Field & Get Matched with a Trainer</h2>
<input id="zipInput" type="text" placeholder="Enter ZIP code" />
<button onclick="searchFields()">Search</button>
<button onclick="useMyLocation()">📍 Use My Location</button>

<div id="map"></div>
<div id="results"></div>

<script>
const trainers = [{"name": "Sebastian Cutler", "zip": 19087, "link": "https://ptptrainings.as.me/sebastiancutlerptp", "position": "Striker", "specialty": "Ball Control", "availability": "Mon\u2013Fri (9am\u20137pm)", "description": "Sebastian is a skilled striker with a focus on ball mastery.", "phone": "610-555-1234", "email": "sebastian@ptp.com"}, {"name": "Ken Roby", "zip": 19333, "link": "https://ptptrainings.as.me/kenrobyptp", "position": "Defender", "specialty": "Speed & Agility", "availability": "Mon\u2013Fri (9am\u20137pm)", "description": "Ken is a current USL League Two player who helps players move faster and smarter.", "phone": "610-551-3399", "email": "kenroby8@gmail.com"}];

let map, geocoder, service;

function initMap() {
  map = new google.maps.Map(document.getElementById('map'), {
    center: { lat: 40.04, lng: -75.39 },
    zoom: 11
  });
  geocoder = new google.maps.Geocoder();
}

function searchFields() {
  const zip = document.getElementById('zipInput').value;
  if (!zip) return alert('Please enter a ZIP code.');
  geocoder.geocode({ address: zip }, (results, status) => {
    if (status === 'OK') {
      const location = results[0].geometry.location;
      map.setCenter(location);
      findSoccerFields(location);
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  });
}

function useMyLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition((position) => {
      const loc = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      map.setCenter(loc);
      findSoccerFields(loc);
    });
  } else {
    alert("Geolocation not supported by this browser.");
  }
}

function findSoccerFields(location) {
  const request = {
    location: location,
    radius: 10000,
    keyword: "soccer field"
  };
  service = new google.maps.places.PlacesService(map);
  service.nearbySearch(request, (results, status) => {
    if (status === google.maps.places.PlacesServiceStatus.OK) {
      results.forEach((place) => {
        const marker = new google.maps.Marker({
          position: place.geometry.location,
          map: map,
          title: place.name
        });
        marker.addListener('click', () => {
          const trainer = matchTrainerRandom();
          document.getElementById('results').innerHTML = displayTrainer(trainer, place.name);
        });
      });
    }
  });
}

function matchTrainerRandom() {
  return trainers[Math.floor(Math.random() * trainers.length)];
}

function displayTrainer(t, fieldName) {
  return `
    <div style='padding: 20px; background: #fffbe6; border-radius: 8px;'>
      <h3>Trainer Match: ${
        t.name
      }</h3>
      <p><strong>📍 Field:</strong> ${
        fieldName
      }</p>
      <p><strong>Specialty:</strong> ${
        t.specialty
      }</p>
      <p><strong>Availability:</strong> ${
        t.availability
      }</p>
      <p><strong>📞 Phone:</strong> ${
        t.phone
      }</p>
      <p><strong>📧 Email:</strong> ${
        t.email
      }</p>
      <p>${
        t.description
      }</p>
      <a href="${
        t.link
      }" target="_blank" style="display:inline-block;margin-top:10px;padding:10px 16px;background:#FFD700;border-radius:6px;text-decoration:none;color:#111;font-weight:bold;">✅ Book a Session</a>
    </div>
  `;
}
</script>

<script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyASLf8mjb8iEbVo99DnaaPzXGlu5jhXrZE&libraries=places&callback=initMap"></script>

</body>
</html>
